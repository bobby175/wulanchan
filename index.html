<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Next...</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@800&display=swap" rel="stylesheet">
    
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            width: 100vw;
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow: hidden;
            color: white;
            background: linear-gradient(-45deg, #ff0000, #ff8c00, #ffe100, #00d624, #00beff, #003cff, #8800ff, #ff0073);
            background-size: 400% 400%;
            animation: gradientFlow 20s ease infinite;
            user-select: none; -webkit-user-select: none;
        }
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        #home-screen {
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            width: 100%; height: 100%; transition: opacity 0.5s ease;
        }
        .clock-container {
            font-size: 18vw; font-weight: 800; letter-spacing: -0.5vw; line-height: 1;
            font-variant-numeric: tabular-nums; text-shadow: 0 10px 30px rgba(0,0,0,0.4);
            display: flex; justify-content: center; align-items: center; gap: 1vw; 
        }
        .colon { animation: blink 1s step-start infinite; position: relative; top: -1.5vw; }
        @keyframes blink { 50% { opacity: 0; } }
        .date-display {
            font-size: 3vh; font-weight: 800; letter-spacing: 0.2rem;
            text-transform: uppercase; margin-top: 1vh; margin-bottom: 3vh;
            text-shadow: 0 5px 10px rgba(0,0,0,0.3);
        }
        .pill-container {
            display: inline-flex; align-items: center; background: rgba(0, 0, 0, 0.25);
            padding: 1.5vh 3vw; border-radius: 100px; gap: 1.5vw;
            border: 2px solid rgba(255,255,255,0.15); backdrop-filter: blur(10px); margin-bottom: 40px;
        }
        .pill-label { font-size: 2vh; color: #ffd700; }
        .pill-time { font-size: 2.5vh; }
        
        .main-btn {
            background: rgba(255, 255, 255, 0.15); 
            border: 1px solid rgba(255,255,255,0.3);
            padding: 10px 30px; 
            border-radius: 50px;
            color: white;
            font-size: 14px; 
            font-weight: 800;
            letter-spacing: 1px;
            cursor: pointer; 
            backdrop-filter: blur(10px); 
            transition: transform 0.2s, background 0.2s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-transform: uppercase;
        }
        .main-btn:hover { background: rgba(255, 255, 255, 0.3); transform: scale(1.05); }

        #modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
            justify-content: center; align-items: center; z-index: 100;
        }
        .modal-box {
            background: rgba(20, 20, 20, 0.9); border: 1px solid rgba(255,255,255,0.2);
            padding: 40px; border-radius: 30px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            animation: popup 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popup { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .game-option-btn {
            display: block; width: 100%; margin: 10px 0; padding: 15px 30px;
            background: linear-gradient(90deg, #00d624, #00beff); border: none;
            border-radius: 15px; color: white; font-weight: bold; font-size: 18px; cursor: pointer;
        }
        .close-btn { background: transparent; border: 1px solid rgba(255,255,255,0.3); margin-top: 15px; }

        #game-screen {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); flex-direction: column;
            justify-content: center; align-items: center; z-index: 200;
        }
        canvas {
            background: rgba(20, 20, 30, 0.5); border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2); box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }
        .game-header {
            display: flex; justify-content: space-between; width: 100%; max-width: 400px;
            margin-bottom: 20px; align-items: center;
        }
        .score-box { display: flex; flex-direction: column; align-items: flex-start; }
        .score-row { display: flex; gap: 15px; }
        .info-text { font-size: 18px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .level-text { color: #00d624; }
        .highscore-text { color: #ffd700; font-size: 14px; margin-bottom: 5px; opacity: 0.9; }
        .back-btn {
            background: #ff0073; border: none; padding: 8px 15px; border-radius: 10px;
            color: white; font-weight: bold; cursor: pointer;
        }
        .tutorial-text { margin-top: 10px; font-size: 14px; opacity: 0.7; text-align: center; }
        
        .mobile-controls { display: none; margin-top: 30px; }
        .d-pad { display: grid; grid-template-columns: repeat(3, 70px); gap: 25px; }
        .ctrl-btn {
            width: 70px; height: 70px; background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.15); border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 30px; cursor: pointer; user-select: none; transition: background 0.1s;
        }
        .ctrl-btn:active { background: rgba(255,255,255,0.4); border-color: white; }

        @media (max-width: 800px) {
            .clock-container { font-size: 13vw; } .colon { top: -0.5vw; }
            .date-display { font-size: 14px; } .pill-container { padding: 10px 20px; }
            .mobile-controls { display: flex; } canvas { width: 90vw; height: 90vw; }
            .game-header { width: 90vw; }
        }
    </style>
</head>
<body>

    <div id="home-screen">
        <div class="clock-container">
            <span id="hours">00</span><span class="colon">:</span>
            <span id="minutes">00</span><span class="colon">:</span>
            <span id="seconds">00</span>
        </div>
        <div class="date-display" id="date">MEMUAT...</div>
        <div class="pill-container">
            <span class="pill-label">NEXT BIRTHDAY</span>
            <span class="pill-time" id="countdown">00d 00h 00m 00s</span>
        </div>
        <button class="main-btn" onclick="openModal()">üéÆ MAIN GAME</button>
    </div>

    <div id="modal-overlay">
        <div class="modal-box">
            <h2>PILIH PERMAINAN</h2>
            <button class="game-option-btn" onclick="startSnakeGame()">üêç SNAKE ROUND</button>
            <button class="game-option-btn close-btn" onclick="closeModal()">BATAL</button>
        </div>
    </div>

    <div id="game-screen">
        <div class="game-header">
            <div class="score-box">
                <div class="info-text highscore-text" id="highScoreBoard">HI: 0</div>
                <div class="score-row">
                    <div class="info-text" id="scoreBoard">SKOR: 0</div>
                    <div class="info-text level-text" id="levelBoard">LVL: 1</div>
                </div>
            </div>
            <button class="back-btn" onclick="exitGame()">KELUAR ‚ùå</button>
        </div>
        
        <canvas id="gameCanvas" width="400" height="400"></canvas>
        <div class="tutorial-text" id="tutorialText">Tekan Arah untuk Mulai. Hindari Ekor!</div>

        <div class="mobile-controls">
            <div class="d-pad">
                <div></div><div class="ctrl-btn" onclick="inputDirection('UP')">‚¨ÜÔ∏è</div><div></div>
                <div class="ctrl-btn" onclick="inputDirection('LEFT')">‚¨ÖÔ∏è</div>
                <div class="ctrl-btn" onclick="inputDirection('DOWN')">‚¨áÔ∏è</div>
                <div class="ctrl-btn" onclick="inputDirection('RIGHT')">‚û°Ô∏è</div>
            </div>
        </div>
    </div>

    <script>
        function updateClock() {
            const now = new Date();
            document.getElementById('hours').innerText = String(now.getHours()).padStart(2, '0');
            document.getElementById('minutes').innerText = String(now.getMinutes()).padStart(2, '0');
            document.getElementById('seconds').innerText = String(now.getSeconds()).padStart(2, '0');
            const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
            document.getElementById('date').innerText = now.toLocaleDateString('en-ID', options);
            const currentYear = now.getFullYear();
            let target = new Date(currentYear, 0, 1);
            if (now > target) target = new Date(currentYear + 1, 0, 1);
            const diff = target - now;
            const d = Math.floor(diff / (1000 * 60 * 60 * 24));
            const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const s = Math.floor((diff % (1000 * 60)) / 1000);
            document.getElementById('countdown').innerText = `${d}d ${h}h ${m}m ${s}s`;
        }
        setInterval(updateClock, 1000); updateClock();

        const homeScreen = document.getElementById('home-screen');
        const modalOverlay = document.getElementById('modal-overlay');
        const gameScreen = document.getElementById('game-screen');
        function openModal() { modalOverlay.style.display = 'flex'; }
        function closeModal() { modalOverlay.style.display = 'none'; }
        function startSnakeGame() { closeModal(); homeScreen.style.display = 'none'; gameScreen.style.display = 'flex'; initGame(); }
        function exitGame() { stopGame(); gameScreen.style.display = 'none'; homeScreen.style.display = 'flex'; }

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('scoreBoard');
        const levelEl = document.getElementById('levelBoard');
        const highScoreEl = document.getElementById('highScoreBoard');
        const tutorialEl = document.getElementById('tutorialText');

        let tileCount = 20;
        let gridSize = canvas.width / tileCount;
        let headX = 10, headY = 10;
        let velocityX = 0, velocityY = 0;
        let appleX = 5, appleY = 5;
        let tail = [];
        let tailLength = 3; 
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let level = 1;
        let applesEaten = 0; 
        let baseSpeed = 180; 
        let currentSpeed = baseSpeed;
        let gameTimeout; 
        let isGameRunning = false;
        let hasStartedMoving = false;

        function initGame() {
            headX = 10; headY = 10; velocityX = 0; velocityY = 0;
            tail = []; tailLength = 3; score = 0; level = 1; applesEaten = 0; currentSpeed = baseSpeed;
            scoreEl.innerText = "SKOR: 0"; levelEl.innerText = "LVL: 1"; highScoreEl.innerText = "HI: " + highScore;
            hasStartedMoving = false; tutorialEl.innerText = "Tekan Arah untuk Mulai. Hindari Ekor!";
            isGameRunning = true; if(gameTimeout) clearTimeout(gameTimeout); gameLoop();
        }

        function stopGame() { isGameRunning = false; if(gameTimeout) clearTimeout(gameTimeout); }

        function gameLoop() {
            if(!isGameRunning) return;
            headX += velocityX; headY += velocityY;
            if (headX < 0) headX = tileCount - 1; if (headX >= tileCount) headX = 0;
            if (headY < 0) headY = tileCount - 1; if (headY >= tileCount) headY = 0;

            if (hasStartedMoving) {
                for (let i = 0; i < tail.length; i++) {
                    if (tail[i].x === headX && tail[i].y === headY) { gameOver(); return; }
                }
            }

            ctx.fillStyle = "rgba(0,0,0,0.6)"; ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (appleX === headX && appleY === headY) {
                tailLength++; score += 10; applesEaten++; scoreEl.innerText = "SKOR: " + score;
                if (score > highScore) { highScore = score; localStorage.setItem('snakeHighScore', highScore); highScoreEl.innerText = "HI: " + highScore; }
                if (applesEaten % 10 === 0) {
                    level++; currentSpeed = Math.max(50, currentSpeed - 15); levelEl.innerText = "LVL: " + level;
                    ctx.fillStyle = "white"; ctx.fillRect(0,0, canvas.width, canvas.height);
                }
                appleX = Math.floor(Math.random() * tileCount); appleY = Math.floor(Math.random() * tileCount);
            }

            drawApple();

            for (let i = 0; i < tail.length; i++) {
                drawSnakeSegment(tail[i].x, tail[i].y, false);
            }
            tail.push({ x: headX, y: headY });
            while (tail.length > tailLength) { tail.shift(); }
            
            drawSnakeHead(headX, headY);

            gameTimeout = setTimeout(gameLoop, currentSpeed);
        }

        function drawSnakeSegment(x, y, isHead) {
            let cx = x * gridSize + gridSize / 2;
            let cy = y * gridSize + gridSize / 2;
            let radius = gridSize / 2 - 2; 

            let grad = ctx.createRadialGradient(cx, cy, radius * 0.3, cx, cy, radius);
            if(isHead) {
                 grad.addColorStop(0, "#ffffff"); grad.addColorStop(1, "#00ffcc");
            } else {
                 grad.addColorStop(0, "#00ffcc"); grad.addColorStop(1, "#008f72");
            }
            ctx.fillStyle = grad;
            ctx.beginPath(); ctx.arc(cx, cy, radius, 0, Math.PI * 2); ctx.fill();

             if(isHead) {
                ctx.fillStyle = "black";
                ctx.beginPath(); 
                ctx.arc(cx - 4, cy - 4, 2.5, 0, Math.PI*2); 
                ctx.arc(cx + 4, cy - 4, 2.5, 0, Math.PI*2);
                ctx.fill();
            }
        }

        function drawSnakeHead(x, y) {
            drawSnakeSegment(x, y, true);
        }

        function drawApple() {
            let cx = appleX * gridSize + gridSize/2; let cy = appleY * gridSize + gridSize/2;
            let gradApple = ctx.createRadialGradient(cx, cy, 2, cx, cy, gridSize/2);
            gradApple.addColorStop(0, "#ff5555"); gradApple.addColorStop(1, "#990000");
            ctx.fillStyle = gradApple; ctx.shadowBlur = 15; ctx.shadowColor = "red";
            ctx.beginPath(); ctx.arc(cx, cy, gridSize/2 - 2, 0, Math.PI*2); ctx.fill(); ctx.shadowBlur = 0;
        }

        function gameOver() {
            stopGame();
            if (score > highScore) { highScore = score; localStorage.setItem('snakeHighScore', highScore); }
            ctx.fillStyle = "rgba(255,255,255,0.9)"; ctx.font = "bold 30px 'Plus Jakarta Sans'"; ctx.textAlign = "center";
            ctx.fillText("GAME OVER", canvas.width/2, canvas.height/2);
            let message = "Skor: " + score; if (score >= highScore && score > 0) message = "REKOR BARU! " + score;
            ctx.font = "18px 'Plus Jakarta Sans'"; ctx.fillStyle = "black";
            ctx.fillText(message, canvas.width/2, canvas.height/2 + 30);
            setTimeout(() => { alert(message + "\nLevel: " + level); initGame(); }, 500);
        }

        function inputDirection(dir) {
            if (!isGameRunning) return; hasStartedMoving = true; tutorialEl.style.display = "none";
            if (dir === 'UP' && velocityY !== 1) { velocityX = 0; velocityY = -1; }
            if (dir === 'DOWN' && velocityY !== -1) { velocityX = 0; velocityY = 1; }
            if (dir === 'LEFT' && velocityX !== 1) { velocityX = -1; velocityY = 0; }
            if (dir === 'RIGHT' && velocityX !== -1) { velocityX = 1; velocityY = 0; }
        }
        document.addEventListener('keydown', (e) => {
            if (gameScreen.style.display === 'flex') {
                if (e.keyCode === 38) inputDirection('UP'); if (e.keyCode === 40) inputDirection('DOWN');
                if (e.keyCode === 37) inputDirection('LEFT'); if (e.keyCode === 39) inputDirection('RIGHT');
            }
        });
    </script>
</body>
</html>
